UPDATE users SET flag_active = 0, username = 'system', password = 'ddeaa159a89375256a02d1cfbd9a1946ad01a979' WHERE username = 'manager';
UPDATE groups SET name = 'System' WHERE id = 2;

-- Database Validation Tool : Ccl
-- ---------------------------------------------------------------------------------------

UPDATE datamart_structure_functions fct, datamart_structures str SET fct.flag_active = '0' WHERE fct.datamart_structure_id = str.id AND str.model = 'DiagnosisMaster' AND label = 'list all related diagnosis';
UPDATE datamart_structure_functions fct, datamart_structures str SET fct.flag_active = '0' WHERE fct.datamart_structure_id = str.id AND str.model = 'Participant' AND label = 'list all related diagnosis';

UPDATE datamart_structure_functions fct, datamart_structures str SET fct.flag_active = '0' WHERE fct.datamart_structure_id = str.id AND str.model = 'TmaSlide' AND label = 'add tma slide use';
UPDATE datamart_structure_functions fct, datamart_structures str SET fct.flag_active = '0' WHERE fct.datamart_structure_id = str.id AND str.model = 'TmaSlideUse' AND label = 'edit';
UPDATE datamart_structure_functions fct, datamart_structures str SET fct.flag_active = '0' WHERE fct.datamart_structure_id = str.id AND str.model = 'TmaSlide' AND label = 'add to order';

-- chronology
-- ---------------------------------------------------------------------------------------

UPDATE structure_formats SET `flag_index`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='chronology') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='custom' AND `tablename`='' AND `field`='time' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');

-- Drug/Treatment update
-- ---------------------------------------------------------------------------------------

UPDATE structure_formats SET `flag_edit`='0', `flag_addgrid`='0', `flag_index`='0', `flag_summary`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='txe_chemos') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='TreatmentExtendDetail' AND `tablename`='txe_chemos' AND `field`='dose' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');
UPDATE structure_formats SET `flag_edit`='0', `flag_addgrid`='0', `flag_index`='0', `flag_summary`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='txe_chemos') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='TreatmentExtendDetail' AND `tablename`='txe_chemos' AND `field`='method' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='chemotherapy_method') AND `flag_confidential`='0');
UPDATE structure_formats SET `flag_override_label`='0', `language_label`='' WHERE structure_id=(SELECT id FROM structures WHERE alias='txe_chemos') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='FunctionManagement' AND `tablename`='' AND `field`='autocomplete_treatment_drug_id' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');

UPDATE treatment_extend_controls 
SET detail_form_alias = 'txe_chemos'
WHERE flag_active = 1;

DELETE FROM structure_formats WHERE structure_id IN (SELECT id FROM structures WHERE alias IN ('qc_tf_txe_chemo_drugs', 'qc_tf_txe_horm_drugs', 'qc_tf_txe_bone_drugs', 'qc_tf_txe_HR_drugs'));
DELETE FROM structures WHERE alias IN ('qc_tf_txe_chemo_drugs', 'qc_tf_txe_horm_drugs', 'qc_tf_txe_bone_drugs', 'qc_tf_txe_HR_drugs');
DELETE FROM structure_validations WHERE structure_field_id IN (SELECT id FROM structure_fields WHERE field = 'drug_id' AND model = 'TreatmentExtendDetail');
DELETE FROM structure_fields WHERE field = 'drug_id' AND model = 'TreatmentExtendDetail';
DELETE FROM structure_value_domains WHERE source like 'Drug.Drug::get%' AND domain_name LIKE '%_drug_list';

INSERT IGNORE INTO i18n (id,en,fr)
VALUES
('at least one selected drug does not match the type of the treatment', "At least one selected drug does not match the type of the treatment!", ""),
('biochemical', 'Biochemical', '');
UPDATE treatment_extend_controls SET type = 'chemotherapy drugs', databrowser_label = 'chemotherapy drugs' WHERE type = 'chemotherpay drugs';
UPDATE treatment_extend_controls SET type = 'hormonotherapy drugs', databrowser_label = 'hormonotherapy drugs' WHERE type = 'hormonotherpay drugs';
INSERT IGNORE INTO i18n (id,en,fr) 
VALUES 
('chemotherapy drugs','Chemotherapy Drugs', ''),
('hormonotherapy drugs','Hormonotherapy Drugs',  '');

-- qc_tf_txd_biopsies_and_turps.type
-- ---------------------------------------------------------------------------------------

ALTER TABLE qc_tf_txd_biopsies_and_turps 
  ADD COLUMN type_specification VARCHAR(100) DEFAULT NULL,
  ADD COLUMN sent_to_chum tinyint(1) DEFAULT '0';
ALTER TABLE qc_tf_txd_biopsies_and_turps_revs
  ADD COLUMN type_specification VARCHAR(100) DEFAULT NULL,
  ADD COLUMN sent_to_chum tinyint(1) DEFAULT '0';  
INSERT INTO structure_value_domains (domain_name, override, category, source) VALUES ("qc_tf_biopsy_type_specifications", "", "", NULL);
INSERT IGNORE INTO structure_permissible_values (value, language_alias) VALUES ("Dx", "Dx"),("follow-up", "follow-up"),("prior to Tx", "prior to Tx");
INSERT IGNORE INTO i18n (id,en,fr) VALUES ("Dx", "Dx", ''),("follow-up", "Follow-up", ''),("prior to Tx", "Prior to Tx", '');
INSERT INTO structure_value_domains_permissible_values (structure_value_domain_id, structure_permissible_value_id, display_order, flag_active) 
VALUES 
((SELECT id FROM structure_value_domains WHERE domain_name="qc_tf_biopsy_type_specifications"), 
(SELECT id FROM structure_permissible_values WHERE value="Dx" AND language_alias="Dx"), "1", "1"),
((SELECT id FROM structure_value_domains WHERE domain_name="qc_tf_biopsy_type_specifications"), 
(SELECT id FROM structure_permissible_values WHERE value="follow-up" AND language_alias="follow-up"), "1", "1"),
((SELECT id FROM structure_value_domains WHERE domain_name="qc_tf_biopsy_type_specifications"), 
(SELECT id FROM structure_permissible_values WHERE value="prior to Tx" AND language_alias="prior to Tx"), "1", "1");
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'TreatmentDetail', 'qc_tf_txd_biopsies_and_turps', 'type_specification', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications') , '0', '', '', '', '', 'specification'), 
('ClinicalAnnotation', 'TreatmentDetail', 'qc_tf_txd_biopsies_and_turps', 'sent_to_chum', 'checkbox',  NULL , '0', '', '', '', 'sent to chum', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_txd_biopsies_and_turps'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='qc_tf_txd_biopsies_and_turps' AND `field`='type_specification' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='specification'), '1', '13', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '1', '0', '1', '0', '1', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_txd_biopsies_and_turps'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='qc_tf_txd_biopsies_and_turps' AND `field`='sent_to_chum' AND `type`='checkbox' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='sent to chum' AND `language_tag`=''), '1', '14', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '1', '0', '1', '0', '1', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0');
INSERT IGNORE INTO i18n (id,en,fr) VALUES ("specification", "Specification", ''),("sent to chum", "Sent To CHUM", '');
SET @modified = (SELECT NOW() FROM users where username = 'system');
SET @modified_by = (SELECT id FROM users where username = 'system');
UPDATE treatment_masters, qc_tf_txd_biopsies_and_turps
SET type = 'Bx', type_specification = 'Dx', modified = @modified, modified_by = @modified_by
WHERE id = treatment_master_id 
AND deleted <> 1
AND type = 'Bx Dx';
UPDATE treatment_masters, qc_tf_txd_biopsies_and_turps
SET type = 'Bx', type_specification = '', sent_to_chum = '1', modified = @modified, modified_by = @modified_by
WHERE id = treatment_master_id 
AND deleted <> 1
AND type = 'Bx CHUM';
UPDATE treatment_masters, qc_tf_txd_biopsies_and_turps
SET type = 'Bx', type_specification = 'prior to Tx', modified = @modified, modified_by = @modified_by
WHERE id = treatment_master_id 
AND deleted <> 1
AND type = 'Bx prior to Tx';
UPDATE treatment_masters, qc_tf_txd_biopsies_and_turps
SET type = 'TURP', type_specification = 'Dx', modified = @modified, modified_by = @modified_by
WHERE id = treatment_master_id 
AND deleted <> 1
AND type = 'TURP Dx';
UPDATE treatment_masters, qc_tf_txd_biopsies_and_turps
SET type = 'Bx TRUS-Guided', type_specification = 'Dx', modified = @modified, modified_by = @modified_by
WHERE id = treatment_master_id 
AND deleted <> 1
AND type = 'Bx Dx TRUS-Guided';
INSERT INTO treatment_masters_revs (treatment_control_id, qc_tf_disease_free_survival_start_events, id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, protocol_master_id, participant_id, diagnosis_master_id, modified_by, version_created) 
(SELECT treatment_control_id, qc_tf_disease_free_survival_start_events, id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, protocol_master_id, participant_id, diagnosis_master_id, modified_by, modified
FROM treatment_masters WHERE modified = @modified AND modified_by = @modified_by);
INSERT INTO qc_tf_txd_biopsies_and_turps_revs (sent_to_chum, total_number_taken, treatment_master_id, gleason_score, total_positive, greatest_percent_of_cancer, gleason_grade, type, ctnm, perineural_invasion, type_specification, version_created)
(SELECT sent_to_chum, total_number_taken, treatment_master_id, gleason_score, total_positive, greatest_percent_of_cancer, gleason_grade, type, ctnm, perineural_invasion, type_specification, modified 
FROM treatment_masters INNER JOIN qc_tf_txd_biopsies_and_turps ON id = treatment_master_id WHERE modified = @modified AND modified_by = @modified_by);
UPDATE structure_value_domains_permissible_values 
SET flag_active = '0'
WHERE structure_value_domain_id = (SELECT id FROM structure_value_domains WHERE domain_name="qc_tf_biopsy_turp_type")
AND structure_permissible_value_id IN (SELECT id FROM structure_permissible_values WHERE value IN ('Bx Dx', 'Bx CHUM', 'Bx prior to Tx', 'Bx Dx TRUS-Guided', 'TURP Dx'));

-- TreatmentControlExtend.id mis match
-- ---------------------------------------------------------------------------------------

SELECT 'Correction of the TreatmentExtendMaster.treatment_extend_control_id vs TreatmentExtendControl.id mismatch' AS '### TODO ###'
UNION ALL
SELECT 'Please check data in array before correction (1st one) and after (2nd one)' AS '### TODO ###';

SELECT count(*),
CONCAT(TreatmentControl.id,'/',TreatmentMaster.treatment_control_id) AS ctrl_vs_master_tx_ctrl_id,
TreatmentControl.tx_method,
CONCAT(IFNULL(TreatmentExtendControl.id, ''),'/',IFNULL(TreatmentExtendMaster.treatment_extend_control_id, '')) AS ctrl_vs_master_tx_ext_ctrl_id,
IF(TreatmentExtendControl.id = TreatmentExtendMaster.treatment_extend_control_id, 'RIGHT', IF(TreatmentExtendMaster.treatment_extend_control_id IS NULL, 'RIGHT', 'ERR')) AS ccl,
TreatmentExtendControl.type AS ctrl_treatment_extend_type,
Drug.type AS drug_type
FROM treatment_masters TreatmentMaster
INNER JOIN treatment_controls TreatmentControl ON TreatmentMaster.treatment_control_id = TreatmentControl.id
LEFT JOIN treatment_extend_masters TreatmentExtendMaster ON TreatmentExtendMaster.treatment_master_id = TreatmentMaster.id AND TreatmentExtendMaster.deleted <> 1
LEFT JOIN treatment_extend_controls TreatmentExtendControl ON TreatmentExtendControl.id = TreatmentControl.treatment_extend_control_id
LEFT JOIN drugs Drug ON Drug.id = TreatmentExtendMaster.drug_id
WHERE TreatmentMaster.deleted <> 1
GROUP BY TreatmentControl.id,Drug.type,TreatmentMaster.treatment_control_id,TreatmentControl.tx_method,TreatmentExtendControl.id,TreatmentExtendMaster.treatment_extend_control_id,TreatmentExtendControl.type
ORDER BY TreatmentExtendControl.id, TreatmentControl.id,Drug.type;

SET @modified = (SELECT NOW() FROM users where username = 'system');
SET @modified_by = (SELECT id FROM users where username = 'system');
UPDATE treatment_masters TreatmentMaster, treatment_controls TreatmentControl, treatment_extend_masters TreatmentExtendMaster, treatment_extend_controls TreatmentExtendControl
SET TreatmentExtendMaster.treatment_extend_control_id = TreatmentExtendControl.id,
TreatmentExtendMaster.modified = @modified,
TreatmentExtendMaster.modified_by = @modified_by
WHERE TreatmentMaster.deleted <> 1
AND TreatmentMaster.treatment_control_id = TreatmentControl.id
AND TreatmentExtendMaster.treatment_master_id = TreatmentMaster.id 
AND TreatmentExtendMaster.deleted <> 1
AND TreatmentExtendControl.id = TreatmentControl.treatment_extend_control_id
AND TreatmentExtendControl.id != TreatmentExtendMaster.treatment_extend_control_id;
INSERT INTO treatment_extend_masters_revs (id,treatment_extend_control_id,treatment_master_id,drug_id,modified_by,version_created)
(SELECT id,treatment_extend_control_id,treatment_master_id,drug_id,modified_by,modified FROM treatment_extend_masters WHERE modified = @modified AND modified_by = @modified_by);
INSERT INTO txe_chemos_revs (dose,method,treatment_extend_master_id,version_created)
(SELECT dose,method,treatment_extend_master_id,modified FROM treatment_extend_masters INNER JOIN txe_chemos ON id = treatment_extend_master_id WHERE modified = @modified AND modified_by = @modified_by);

SELECT count(*),
CONCAT(TreatmentControl.id,'/',TreatmentMaster.treatment_control_id) AS ctrl_vs_master_tx_ctrl_id,
TreatmentControl.tx_method,
CONCAT(IFNULL(TreatmentExtendControl.id, ''),'/',IFNULL(TreatmentExtendMaster.treatment_extend_control_id, '')) AS ctrl_vs_master_tx_ext_ctrl_id,
IF(TreatmentExtendControl.id = TreatmentExtendMaster.treatment_extend_control_id, 'RIGHT', IF(TreatmentExtendMaster.treatment_extend_control_id IS NULL, 'RIGHT', 'ERR')) AS ccl,
TreatmentExtendControl.type AS ctrl_treatment_extend_type,
Drug.type AS drug_type
FROM treatment_masters TreatmentMaster
INNER JOIN treatment_controls TreatmentControl ON TreatmentMaster.treatment_control_id = TreatmentControl.id
LEFT JOIN treatment_extend_masters TreatmentExtendMaster ON TreatmentExtendMaster.treatment_master_id = TreatmentMaster.id AND TreatmentExtendMaster.deleted <> 1
LEFT JOIN treatment_extend_controls TreatmentExtendControl ON TreatmentExtendControl.id = TreatmentControl.treatment_extend_control_id
LEFT JOIN drugs Drug ON Drug.id = TreatmentExtendMaster.drug_id
WHERE TreatmentMaster.deleted <> 1
GROUP BY TreatmentControl.id,Drug.type,TreatmentMaster.treatment_control_id,TreatmentControl.tx_method,TreatmentExtendControl.id,TreatmentExtendMaster.treatment_extend_control_id,TreatmentExtendControl.type
ORDER BY TreatmentExtendControl.id, TreatmentControl.id,Drug.type;

-- Report buildCpcbnSummary()
-- ---------------------------------------------------------------------------------------

UPDATE structure_fields SET sortable = 1 WHERE id IN (SELECT structure_field_id FROM structure_formats INNER JOIN structures ON structures.id = structure_id WHERE alias = 'qc_tf_cpcbn_summary_results') AND model = 'Generated';

-- Report activeSurveillanceReport()

SET @modified = (SELECT NOW() FROM users where username = 'system');
SET @modified_by = (SELECT id FROM users where username = 'system');
INSERT INTO `datamart_reports` (`id`, `name`, `description`, `form_alias_for_search`, `form_alias_for_results`, `form_type_for_results`, `function`, `flag_active`, `associated_datamart_structure_id`, `limit_access_from_datamart_structrue_function`) 
VALUES
(null, 'CPCBN - Active Surveillance Report', '', 'qc_tf_cpcbn_summary_parameters', 'qc_tf_cpcbn_active_surveillance_report_results', 'index', 'activeSurveillanceReport', 1, (SELECT id FROM datamart_structures WHERE model = 'Participant'), 0);
SET @control_id = (SELECT id FROM datamart_reports WHERE name = 'CPCBN - Active Surveillance Report');
INSERT INTO datamart_structure_functions (`datamart_structure_id`, `label`, `link`, `flag_active`, `ref_single_fct_link`)
VALUES
((SELECT id FROM datamart_structures WHERE model = 'Participant'), 'CPCBN - Active Surveillance Report', CONCAT('/Datamart/Reports/manageReport/',@control_id), 1, ''),
((SELECT id FROM datamart_structures WHERE model = 'NonTmaBlockStorage'), 'CPCBN - Active Surveillance Report', CONCAT('/Datamart/Reports/manageReport/',@control_id), 1, '');

INSERT INTO structures(`alias`) VALUES ('qc_tf_cpcbn_active_surveillance_report_results');
DELETE FROM structure_formats WHERE structure_id = (SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results');
-- Profile
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_bank_id' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='banks')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='bank' AND `language_tag`=''), '0', '0', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='participant_identifier' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0'), '0', '2', 'profile', '0', '0', '', '0', '', '0', '', '1', 'integer_positive', '1', 'size=10', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_bank_participant_identifier' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=20' AND `default`='' AND `language_help`='' AND `language_label`='bank patient #' AND `language_tag`=''), '0', '4', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_study_exclusions' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='study exclusion' AND `language_tag`=''), '0', '6', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='vital_status' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='health_status')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='help_vital status' AND `language_label`='vital status' AND `language_tag`=''), '0', '8', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_death_from_prostate_cancer' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='death from prostate cancer' AND `language_tag`=''), '0', '10', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='date_of_death' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='help_date of death' AND `language_label`='date of death' AND `language_tag`=''), '0', '12', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='is_suspected_date_of_death' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='is suspected date of death' AND `language_tag`=''), '0', '14', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_last_contact' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='last contact' AND `language_tag`=''), '0', '16', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Dx
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='DiagnosisMaster' AND `tablename`='diagnosis_masters' AND `field`='dx_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='help_dx date' AND `language_label`='dx_date' AND `language_tag`=''), '0', '200', 'diagnosis', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='DiagnosisMaster' AND `tablename`='diagnosis_masters' AND `field`='age_at_dx' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0'), '0', '201', '', '0', '1', 'age at diagnosis', '0', '', '1', '', '0', '', '1', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='DiagnosisDetail' AND `tablename`='qc_tf_dxd_cpcbn' AND `field`='tool' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_dx_tool')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='diagnosis method' AND `language_tag`=''), '0', '204', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='DiagnosisDetail' AND `tablename`='qc_tf_dxd_cpcbn' AND `field`='ptnm' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ptnm')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='ptnm' AND `language_tag`=''), '0', '208', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- RP
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', '0', '', 'qc_tf_age_at_rp', 'integer',  NULL , '0', '', '', '', 'age at rp', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentMaster' AND `tablename`='treatment_masters' AND `field`='start_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='help_start_date' AND `language_label`='date/start date' AND `language_tag`=''), '0', '300', 'RP', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='0' AND `tablename`='' AND `field`='qc_tf_age_at_rp' AND `type`='integer' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='age at rp' AND `language_tag`=''), '0', '304', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_gleason_grade' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason grade' AND `language_tag`=''), '0', '308', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_gleason_score' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason sum' AND `language_tag`=''), '0', '312', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_lymph_node_invasion' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='lymph node invasion' AND `language_tag`=''), '0', '316', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_capsular_penetration' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='capsular penetration' AND `language_tag`=''), '0', '320', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_seminal_vesicle_invasion' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='seminal vesicle invasion' AND `language_tag`=''), '0', '324', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='txd_surgeries' AND `field`='qc_tf_margin' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='margin' AND `language_tag`=''), '0', '328', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_rp_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_rp_psa', 'date',  NULL , '0', '', '', '', '', 'on'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_rp_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa after ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_rp_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_rp_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior ng per ml' AND `language_tag`=''), '0', '330', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_rp_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '331', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_rp_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa after ng per ml' AND `language_tag`=''), '0', '332', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_rp_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '333', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Bx Dx
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_start_date', 'date',  NULL , '0', '', '', '', 'date', ''),
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_type', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type') , '0', '', '', '', 'type', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_type_specification', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications') , '0', '', '', '', '', 'specification'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_sent_to_chum', 'checkbox',  NULL , '0', '', '', '', 'sent to chum', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_gleason_grade', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades') , '0', '', '', '', 'gleason grade', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_gleason_score', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values') , '0', '', '', '', 'gleason score', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_total_positive', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total positive', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_total_number_taken', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total number taken', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_greatest_percent_of_cancer', 'integer_positive',  NULL , '0', 'size=3', '', '', 'greatest percent of cancer', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_dx_ctnm', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm') , '0', '', '', '', 'ctnm', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_start_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='date' AND `language_tag`=''), '0', '400', 'biopsy/turp - Dx', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='type' AND `language_tag`=''), '0', '404', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
-- ((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_type_specification' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='specification'), '0', '408', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_sent_to_chum' AND `type`='checkbox' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='sent to chum' AND `language_tag`=''), '0', '412', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_gleason_grade' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason grade' AND `language_tag`=''), '0', '416', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_gleason_score' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason score' AND `language_tag`=''), '0', '420', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_total_positive' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total positive' AND `language_tag`=''), '0', '422', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_total_number_taken' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total number taken' AND `language_tag`=''), '0', '424', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_greatest_percent_of_cancer' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='greatest percent of cancer' AND `language_tag`=''), '0', '428', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_dx_ctnm' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='ctnm' AND `language_tag`=''), '0', '432', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_dx_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_dx_psa', 'date',  NULL , '0', '', '', '', '', 'on'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_dx_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa after ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_dx_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_dx_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior ng per ml' AND `language_tag`=''), '0', '440', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_dx_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '441', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_dx_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa after ng per ml' AND `language_tag`=''), '0', '442', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_dx_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '443', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Bx Sent to chum
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_start_date', 'date',  NULL , '0', '', '', '', 'date', ''),
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_type', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type') , '0', '', '', '', 'type', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_type_specification', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications') , '0', '', '', '', '', 'specification'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_sent_to_chum', 'checkbox',  NULL , '0', '', '', '', 'sent to chum', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_gleason_grade', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades') , '0', '', '', '', 'gleason grade', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_gleason_score', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values') , '0', '', '', '', 'gleason score', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_total_positive', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total positive', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_total_number_taken', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total number taken', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_greatest_percent_of_cancer', 'integer_positive',  NULL , '0', 'size=3', '', '', 'greatest percent of cancer', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_chum_ctnm', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm') , '0', '', '', '', 'ctnm', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_start_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='date' AND `language_tag`=''), '0', '400', 'biopsy/turp - sent to chum', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='type' AND `language_tag`=''), '0', '404', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_type_specification' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='specification'), '0', '408', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
-- ((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_sent_to_chum' AND `type`='checkbox' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='sent to chum' AND `language_tag`=''), '0', '412', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_gleason_grade' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason grade' AND `language_tag`=''), '0', '416', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_gleason_score' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason score' AND `language_tag`=''), '0', '420', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_total_positive' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total positive' AND `language_tag`=''), '0', '422', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_total_number_taken' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total number taken' AND `language_tag`=''), '0', '424', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_greatest_percent_of_cancer' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='greatest percent of cancer' AND `language_tag`=''), '0', '428', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_chum_ctnm' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='ctnm' AND `language_tag`=''), '0', '432', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
UPDATE structure_formats SET display_order = (display_order+50) WHERE structure_id = (SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results') AND structure_field_id IN (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field` LIKE 'qc_tf_bx_chum_%');
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_chum_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_chum_psa', 'date',  NULL , '0', '', '', '', '', 'on'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_chum_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa after ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_chum_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_chum_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior ng per ml' AND `language_tag`=''), '0', '490', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_chum_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '491', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_chum_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa after ng per ml' AND `language_tag`=''), '0', '492', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_chum_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '493', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Bx Last
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_start_date', 'date',  NULL , '0', '', '', '', 'date', ''),
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_type', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type') , '0', '', '', '', 'type', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_type_specification', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications') , '0', '', '', '', '', 'specification'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_sent_to_chum', 'checkbox',  NULL , '0', '', '', '', 'sent to chum', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_gleason_grade', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades') , '0', '', '', '', 'gleason grade', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_gleason_score', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values') , '0', '', '', '', 'gleason score', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_total_positive', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total positive', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_total_number_taken', 'integer_positive',  NULL , '0', 'size=3', '', '', 'total number taken', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_greatest_percent_of_cancer', 'integer_positive',  NULL , '0', 'size=3', '', '', 'greatest percent of cancer', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_bx_last_ctnm', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm') , '0', '', '', '', 'ctnm', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_start_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='date' AND `language_tag`=''), '0', '400', 'biopsy/turp - last', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_turp_type')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='type' AND `language_tag`=''), '0', '404', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_type_specification' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_biopsy_type_specifications')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='specification'), '0', '408', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_sent_to_chum' AND `type`='checkbox' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='sent to chum' AND `language_tag`=''), '0', '412', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_gleason_grade' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_grades')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason grade' AND `language_tag`=''), '0', '416', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_gleason_score' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_gleason_values')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='gleason score' AND `language_tag`=''), '0', '420', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_total_positive' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total positive' AND `language_tag`=''), '0', '422', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_total_number_taken' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='total number taken' AND `language_tag`=''), '0', '424', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_greatest_percent_of_cancer' AND `type`='integer_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='size=3' AND `default`='' AND `language_help`='' AND `language_label`='greatest percent of cancer' AND `language_tag`=''), '0', '428', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_bx_last_ctnm' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_ctnm')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='ctnm' AND `language_tag`=''), '0', '432', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
UPDATE structure_formats SET display_order = (display_order+100) WHERE structure_id = (SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results') AND structure_field_id IN (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field` LIKE 'qc_tf_bx_last_%');
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_last_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_bx_last_psa', 'date',  NULL , '0', '', '', '', '', 'on'), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_last_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa after ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_after_bx_last_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_last_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior ng per ml' AND `language_tag`=''), '0', '540', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_bx_last_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '541', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_last_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa after ng per ml' AND `language_tag`=''), '0', '542', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_after_bx_last_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '543', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- 1st BCR
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='FstBcrDiagnosisMaster' AND `tablename`='' AND `field`='first_bcr_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='first bcr date' AND `language_tag`=''), '0', '800', 'first bcr', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_rp_to_bcr' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='rp to bcr'), '0', '804', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='FstBcrDiagnosisDetail' AND `tablename`='' AND `field`='first_bcr_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_date_biochemical_recurrence_definition')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='first bcr type' AND `language_tag`=''), '0', '808', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'); 
-- Other Treatments
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_chemo_flag' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='chemotherapy' AND `language_tag`=''), '0', '850', 'treatments', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_chemo_first_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='first date'), '0', '854', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_radiation_flag' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='radiation' AND `language_tag`=''), '0', '858', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_radiation_details' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`=''), '0', '862', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_radiation_first_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='first date'), '0', '868', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_hormono_flag' AND `type`='yes_no' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='hormonotherapy' AND `language_tag`=''), '0', '872', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_hormono_first_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='first date'), '0', '876', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'); 
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_chemo_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior chemo ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_chemo_psa', 'date',  NULL , '0', '', '', '', '', 'on'),
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_radiation_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior radiation ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_radiation_psa', 'date',  NULL , '0', '', '', '', '', 'on'),
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_hormono_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'psa prior hormono ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_prior_hormono_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_chemo_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior chemo ng per ml' AND `language_tag`=''), '0', '855', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_chemo_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '856', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_radiation_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior radiation ng per ml' AND `language_tag`=''), '0', '869', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_radiation_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '870', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'),
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_hormono_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='psa prior hormono ng per ml' AND `language_tag`=''), '0', '877', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_prior_hormono_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '878', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Last PSA
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'Generated', '', 'qc_tf_last_psa_ng_per_ml', 'float_positive',  NULL , '0', '', '', '', 'last psa ng per ml', ''), 
('ClinicalAnnotation', 'Generated', '', 'qc_tf_last_psa', 'date',  NULL , '0', '', '', '', '', 'on');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_last_psa_ng_per_ml' AND `type`='float_positive' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='last psa ng per ml' AND `language_tag`=''), '0', '1100', 'last psa', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_last_psa' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='on'), '0', '1101', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Metastases
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Metastasis' AND `tablename`='' AND `field`='first_metastasis_dx_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='first metastasis date' AND `language_tag`=''), '0', '1200', 'metastases', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Metastasis' AND `tablename`='' AND `field`='first_metastasis_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_metastasis_type')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='first metastasis type' AND `language_tag`=''), '0', '1204', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Metastasis' AND `tablename`='' AND `field`='qc_tf_first_bone_metastasis_date' AND `type`='date' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='first bone metastasis date' AND `language_tag`=''), '0', '1208', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Generated' AND `tablename`='' AND `field`='qc_tf_rp_to_bone_met' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='' AND `language_tag`='rp to bone met'), '0', '1212', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0'), 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Metastasis' AND `tablename`='' AND `field`='other_types' AND `type`='input' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='other metastases' AND `language_tag`=''), '0', '1216', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- Collections date
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_cpcbn_active_surveillance_report_results'), (SELECT id FROM structure_fields WHERE `model`='Collection' AND `tablename`='collections' AND `field`='collection_datetime' AND `type`='datetime' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='inv_collection_datetime_defintion' AND `language_label`='collection datetime' AND `language_tag`=''), '0', '295', 'collection', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0');
-- i18n
INSERT IGNORE INTO i18n (id,en,fr)
VALUES
('last psa', 'Last PSA', ''),
('last psa ng per ml', 'Last PSA (ng/ml)', ''),
('psa prior chemo ng per ml', 'PSA-Prior Chemo (ng/ml)', ''),
('psa prior radiation ng per ml', 'PSA-Prior Radio (ng/ml)', ''),
('psa prior hormono ng per ml', 'PSA-Prior Hormono (ng/ml)', ''),
('psa prior ng per ml', 'PSA-Prior (ng/ml)', ''), 
('psa after ng per ml', 'PSA-After (ng/ml)', ''), 
('on', 'On', ''),
('at least one participant has 2 collections recorded into ATiM', 'At least one participant has 2 collections recorded into ATiM', ''),
('at least one participant has 2 biopsies or turps defined as sent to chum', 'At least one participant has 2 biopsies or TURPs defined as sent to chum', ''),
('biopsy/turp - Dx', 'Biopsy/TURP - Dx' ,''),
('biopsy/turp - sent to chum', 'Biopsy/TURP - Sent to CHUM' ,''),
('biopsy/turp - last', 'Biopsy/TURP - Last' ,''),
('age at rp', 'Age at RP', ''),
('CPCBN - Active Surveillance Report', 'CPCBN - Active Surveillance Report', '');

-- Flag Biopsy 'Sent To Chum' based on collection 
-- ---------------------------------------------------------------------------------------

SET @modified = (SELECT NOW() FROM users where username = 'system');
SET @modified_by = (SELECT id FROM users where username = 'system');
UPDATE collections Collection, treatment_masters TreatmentMaster, qc_tf_txd_biopsies_and_turps TreatmentDetail
SET TreatmentDetail.sent_to_chum = '1', TreatmentMaster.modified = @modified, TreatmentMaster.modified_by = @modified_by
WHERE Collection.deleted <> 1
AND collection_datetime_accuracy IN ('', 'h', 'c')
AND Collection.participant_id = TreatmentMaster.participant_id
AND TreatmentMaster.treatment_control_id = 8
AND TreatmentMaster.deleted <> 1
AND TreatmentMaster.start_date IS NOT NULL
AND TreatmentMaster.start_date = DATE_FORMAT(Collection.collection_datetime, "%Y-%m-%d")
AND TreatmentDetail.treatment_master_id = TreatmentMaster.id
AND TreatmentDetail.sent_to_chum != '1';
INSERT INTO treatment_masters_revs (id, treatment_control_id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, modified_by, protocol_master_id, participant_id, diagnosis_master_id, version_created, qc_tf_disease_free_survival_start_events)
(SELECT id, treatment_control_id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, modified_by, protocol_master_id, participant_id, diagnosis_master_id, modified, qc_tf_disease_free_survival_start_events
FROM treatment_masters
WHERE modified = @modified AND modified_by = @modified_by);
INSERT INTO treatment_masters_revs (id, treatment_control_id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, modified_by, protocol_master_id, participant_id, diagnosis_master_id, version_created, qc_tf_disease_free_survival_start_events)
(SELECT id, treatment_control_id, tx_intent, target_site_icdo, start_date, start_date_accuracy, finish_date, finish_date_accuracy, information_source, facility, notes, modified_by, protocol_master_id, participant_id, diagnosis_master_id, modified, qc_tf_disease_free_survival_start_events
FROM treatment_masters
WHERE modified = @modified AND modified_by = @modified_by);
INSERT INTO qc_tf_txd_biopsies_and_turps_revs (total_number_taken, treatment_master_id, version_created, gleason_score, total_positive, greatest_percent_of_cancer, gleason_grade, type, ctnm, perineural_invasion, type_specification, sent_to_chum)
(SELECT total_number_taken, treatment_master_id, modified, gleason_score, total_positive, greatest_percent_of_cancer, gleason_grade, type, ctnm, perineural_invasion, type_specification, sent_to_chum
FROM treatment_masters INNER JOIN qc_tf_txd_biopsies_and_turps ON treatment_master_id = id 
WHERE modified = @modified AND modified_by = @modified_by);

-- Add csv file in main form search for participant_identifier and qc_tf_bank_participant_identifier
-- ---------------------------------------------------------------------------------------

UPDATE structure_formats SET `flag_override_setting`='1', `setting`='size=10,class=file' WHERE structure_id=(SELECT id FROM structures WHERE alias='participants') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='participant_identifier' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');
UPDATE structure_formats SET `flag_override_setting`='1', `setting`='size=20,class=file' WHERE structure_id=(SELECT id FROM structures WHERE alias='participants') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='Participant' AND `tablename`='participants' AND `field`='qc_tf_bank_participant_identifier' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');
UPDATE structure_fields SET  `type`='integer_positive',  `setting`='size=10,class=file' WHERE model='ViewCollection' AND tablename='' AND field='participant_identifier' AND `type`='input' AND structure_value_domain  IS NULL ;
UPDATE structure_fields SET  `setting`='size=30,class=file' WHERE model='ViewCollection' AND tablename='' AND field='qc_tf_bank_participant_identifier' AND `type`='input' AND structure_value_domain  IS NULL ;
UPDATE structure_formats SET `flag_override_type`='0', `type`='', `flag_override_setting`='0', `setting`='' WHERE structure_id=(SELECT id FROM structures WHERE alias='view_collection') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='ViewCollection' AND `tablename`='' AND `field`='participant_identifier' AND `structure_value_domain`  IS NULL  AND `flag_confidential`='0');
UPDATE structure_fields SET  `setting`='size=10,class=file' WHERE model='ViewAliquot' AND tablename='' AND field='participant_identifier' AND `type`='integer_positive' AND structure_value_domain  IS NULL ;
UPDATE structure_fields SET  `setting`='size=20,class=file' WHERE model='ViewAliquot' AND tablename='' AND field='qc_tf_bank_participant_identifier' AND `type`='input' AND structure_value_domain  IS NULL ;

-- Add csv file in main form search for participant_identifier and qc_tf_bank_participant_identifier
-- ---------------------------------------------------------------------------------------

INSERT INTO treatment_controls (tx_method, flag_active, detail_tablename, detail_form_alias, display_order, applied_protocol_control_id, extended_data_import_process, databrowser_label, flag_use_for_ccl, treatment_extend_control_id, use_addgrid, use_detail_form_for_index)
(SELECT 'surgery for metastasis', 1, detail_tablename, '', display_order, null, extended_data_import_process, 'surgery for metastasis', '0', null, use_addgrid, use_detail_form_for_index FROM treatment_controls WHERE tx_method = 'surgery');
INSERT INTO i18n (id,en,fr) VALUES ('surgery for metastasis', 'Surgery for Metastasis', '');

-- Add csv file in main form search for participant_identifier and qc_tf_bank_participant_identifier
-- ---------------------------------------------------------------------------------------

SELECT DISTINCT tma_block_storage_master_id as '### ERROR TMA Blocks (id) with sildes with different types', qc_tf_cpcbn_slide_type 
FROM (
	SELECT count(*) AS  count_types, tma_block_storage_master_id AS tma_block_id
	FROM (
		SELECT DISTINCT tma_block_storage_master_id, qc_tf_cpcbn_slide_type FROM tma_slides WHERE deleted <> 1 order by tma_block_storage_master_id
	) Res 
	GROUP BY tma_block_storage_master_id
) Res2,
tma_slides
WHERE tma_slides.tma_block_storage_master_id = Res2.tma_block_id
AND tma_slides.deleted <> 1
AND Res2.count_types > 1;

ALTER TABLE std_tma_blocks
  ADD COLUMN qc_tf_cpcbn_block_type VARCHAR(50) DEFAULT NULL;
ALTER TABLE std_tma_blocks_revs
  ADD COLUMN qc_tf_cpcbn_block_type VARCHAR(50) DEFAULT NULL;
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('StorageLayout', 'StorageDetail', 'std_tma_blocks', 'qc_tf_cpcbn_block_type', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_cpcbn_tma_slide_type') , '0', '', '', '', 'type', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='std_tma_blocks'), (SELECT id FROM structure_fields WHERE `model`='StorageDetail' AND `tablename`='std_tma_blocks' AND `field`='qc_tf_cpcbn_block_type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_cpcbn_tma_slide_type')  AND `flag_confidential`='0' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='type' AND `language_tag`=''), '1', '25', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '1', '0', '1', '0', '1', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0');
INSERT INTO structure_validations (structure_field_id, rule, language_message)
VALUES
((SELECT id FROM structure_fields WHERE `model`='StorageDetail' AND `tablename`='std_tma_blocks' AND `field`='qc_tf_cpcbn_block_type'), 'notBlank', '');
INSERT INTO structure_validations (structure_field_id, rule, language_message)
VALUES
((SELECT id FROM structure_fields WHERE `model`='StorageDetail' AND `tablename`='std_tma_blocks' AND `field`='qc_tf_cpcbn_block_type'), 'notBlank', '');

SET @modified = (SELECT NOW() FROM users where username = 'system');
SET @modified_by = (SELECT id FROM users where username = 'system');
UPDATE storage_masters StorageMaster, std_tma_blocks StorageDetail, tma_slides TmaSlide
SET qc_tf_cpcbn_block_type = qc_tf_cpcbn_slide_type, StorageMaster.modified = @modified, StorageMaster.modified_by = @modified_by
WHERE TmaSlide.deleted <> 1
AND TmaSlide.tma_block_storage_master_id = StorageMaster.id
AND StorageMaster.deleted <> 1
AND StorageMaster.id = StorageDetail.storage_master_id
AND qc_tf_cpcbn_slide_type IS NOT NULL AND qc_tf_cpcbn_slide_type NOT LIKE '';
INSERT INTO storage_masters_revs (storage_control_id, id, code, parent_id, lft, rght, barcode, short_label, selection_label, storage_status, parent_storage_coord_x, parent_storage_coord_y, temperature, temp_unit, notes, 
qc_tf_tma_name, qc_tf_tma_label_site, qc_tf_bank_id, modified_by, version_created)
(SELECT storage_control_id, id, code, parent_id, lft, rght, barcode, short_label, selection_label, storage_status, parent_storage_coord_x, parent_storage_coord_y, temperature, temp_unit, notes, 
qc_tf_tma_name, qc_tf_tma_label_site, qc_tf_bank_id, modified_by, modified FROM storage_masters WHERE modified = @modified AND modified_by = @modified_by);
INSERT INTO std_tma_blocks_revs (storage_master_id, sop_master_id, product_code, creation_datetime, creation_datetime_accuracy, qc_tf_cpcbn_block_type, version_created) 
(SELECT storage_master_id, sop_master_id, product_code, creation_datetime, creation_datetime_accuracy, qc_tf_cpcbn_block_type, modified 
FROM storage_masters INNER JOIN std_tma_blocks ON id = storage_master_id WHERE modified = @modified AND modified_by = @modified_by);
UPDATE structure_formats SET `flag_add`='0', `flag_edit`='0', `flag_addgrid`='0', `flag_editgrid`='0', `flag_index`='0', `flag_detail`='0' WHERE structure_id=(SELECT id FROM structures WHERE alias='tma_slides') AND structure_field_id=(SELECT id FROM structure_fields WHERE `model`='TmaSlide' AND `tablename`='tma_slides' AND `field`='qc_tf_cpcbn_slide_type' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_cpcbn_tma_slide_type') AND `flag_confidential`='0');

-- ---------------------------------------------------------------------------------------

UPDATE versions SET branch_build_number = '7048' WHERE version_number = '2.7.0';

-- ---------------------------------------------------------------------------------------
-- 20180720
-- ---------------------------------------------------------------------------------------

ALTER TABLE qc_tf_txd_hormonotherapies ADD COLUMN type varchar(50) DEFAULT NULL;
ALTER TABLE qc_tf_txd_hormonotherapies_revs ADD COLUMN type varchar(50) DEFAULT NULL;

INSERT INTO structure_value_domains (domain_name, source) 
VALUES 
('qc_tf_cpcbn_hormonotherapy_type', "StructurePermissibleValuesCustom::getCustomDropdown('Hormonotherapy Types')");
INSERT INTO structure_permissible_values_custom_controls (name, flag_active, values_max_length, category) 
VALUES 
('Hormonotherapy Types', 1, 50, 'clinical - annotation');
SET @control_id = (SELECT id FROM structure_permissible_values_custom_controls WHERE name = 'Hormonotherapy Types');
INSERT INTO `structure_permissible_values_customs` (`value`, `en`, `fr`, `use_as_input`, `control_id`, `modified`, `created`, `created_by`, `modified_by`)
VALUES
('neo-adjuvant', '',  '', '1', @control_id, NOW(), NOW(), 1, 1), 
('adjuvant', '',  '', '1', @control_id, NOW(), NOW(), 1, 1), 
('curative', '',  '', '1', @control_id, NOW(), NOW(), 1, 1), 
('salvage', '',  '', '1', @control_id, NOW(), NOW(), 1, 1);
INSERT INTO structure_fields(`plugin`, `model`, `tablename`, `field`, `type`, `structure_value_domain`, `flag_confidential`, `setting`, `default`, `language_help`, `language_label`, `language_tag`) VALUES
('ClinicalAnnotation', 'TreatmentDetail', 'qc_tf_txd_hormonotherapies', 'type', 'select', (SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_cpcbn_hormonotherapy_type') , '1', '', '', '', 'type', '');
INSERT INTO structure_formats(`structure_id`, `structure_field_id`, `display_column`, `display_order`, `language_heading`, `margin`, `flag_override_label`, `language_label`, `flag_override_tag`, `language_tag`, `flag_override_help`, `language_help`, `flag_override_type`, `type`, `flag_override_setting`, `setting`, `flag_override_default`, `default`, `flag_add`, `flag_add_readonly`, `flag_edit`, `flag_edit_readonly`, `flag_search`, `flag_search_readonly`, `flag_addgrid`, `flag_addgrid_readonly`, `flag_editgrid`, `flag_editgrid_readonly`, `flag_batchedit`, `flag_batchedit_readonly`, `flag_index`, `flag_detail`, `flag_summary`, `flag_float`) VALUES 
((SELECT id FROM structures WHERE alias='qc_tf_txd_hormonotherapy'), (SELECT id FROM structure_fields WHERE `model`='TreatmentDetail' AND `tablename`='qc_tf_txd_hormonotherapies' AND `field`='type' AND `type`='select' AND `structure_value_domain` =(SELECT id FROM structure_value_domains WHERE domain_name='qc_tf_cpcbn_hormonotherapy_type')  AND `flag_confidential`='1' AND `setting`='' AND `default`='' AND `language_help`='' AND `language_label`='type' AND `language_tag`=''), '1', '6', '', '0', '0', '', '0', '', '0', '', '0', '', '0', '', '0', '', '1', '0', '1', '0', '1', '0', '0', '0', '0', '0', '0', '0', '1', '1', '1', '0');

SET @control_id = (SELECT id FROM structure_permissible_values_custom_controls WHERE name = 'radiotherapy types');
INSERT INTO `structure_permissible_values_customs` (`value`, `en`, `fr`, `use_as_input`, `control_id`, `modified`, `created`, `created_by`, `modified_by`)
VALUES
('brachytherapy', '',  '', '1', @control_id, NOW(), NOW(), 1, 1);

UPDATE versions SET branch_build_number = '7271' WHERE version_number = '2.7.0';