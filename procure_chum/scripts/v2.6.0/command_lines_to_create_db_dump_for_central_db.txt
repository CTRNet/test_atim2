# ######################################################################v
# Dump for ATiM PROCURE Central (every saturday 8am)
# ######################################################################v

# Dump data

0 8 * * 6 mysqldump -u root -pxxxxx atimprocureprod --tables ad_blocks ad_tissue_slides ad_tubes ad_whatman_papers aliquot_controls aliquot_internal_uses aliquot_masters aliquot_masters_revs aliquot_review_controls aliquot_review_masters collections consent_controls consent_masters derivative_details diagnosis_controls drugs event_controls event_masters misc_identifier_controls misc_identifiers orders order_items order_lines participants parent_to_derivative_sample_controls procure_cd_sigantures procure_ar_tissue_slides procure_ed_clinical_followup_worksheet_aps procure_ed_clinical_followup_worksheet_clinical_events procure_ed_clinical_followup_worksheets procure_ed_followup_worksheet_clinical_notes procure_ed_followup_worksheet_other_tumor_diagnosis > /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step1.sql
5 8 * * 6 mysqldump -u root -pxxxxx atimprocureprod --tables procure_ed_lab_diagnostic_information_worksheets procure_ed_lab_pathologies procure_ed_lifestyle_quest_admin_worksheets procure_spr_prostate procure_txd_followup_worksheet_other_tumor_treatments procure_txd_followup_worksheet_treatments procure_txd_medication_drugs procure_txd_medications quality_ctrls realiquotings sample_controls sample_masters sd_der_amp_rnas sd_der_cdnas sd_der_dnas sd_der_pbmcs sd_der_plasmas sd_der_rnas sd_der_serums sd_der_urine_cents sd_spe_bloods sd_spe_tissues sd_spe_urines shipments source_aliquots specimen_details specimen_review_controls specimen_review_masters std_boxs std_cupboards std_customs std_freezers std_fridges std_incubators std_nitro_locates std_racks > /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step2.sql
10 8 * * 6 mysqldump -u root -pxxxxx atimprocureprod --tables std_rooms std_shelfs std_tma_blocks storage_controls storage_masters storage_masters_revs structure_permissible_values structure_permissible_values_custom_controls structure_permissible_values_customs structure_value_domains structure_value_domains_permissible_values study_summaries treatment_controls treatment_extend_controls treatment_masters > /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step3.sql

# Load dump

15 8 * * 6 mysql -u root -pxxxxx atimprocureprod_central_copy --default-character-set=utf8 < /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step1.sql
20 8 * * 6 mysql -u root -pxxxxx atimprocureprod_central_copy --default-character-set=utf8 < /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step2.sql
25 8 * * 6 mysql -u root -pxxxxx atimprocureprod_central_copy --default-character-set=utf8 < /ATiM/atim-procure/db_dump_for_central/dump_atimprocureprod_temp-step3.sql

# Denominalize dump

30 8 * * 6 mysql -u root -pxxxxx atimprocureprod_central_copy --default-character-set=utf8 < /ATiM/atim-procure/db_dump_for_central/denominalize_procure_chum_dump_for_central.sql

# Create file to sFTP

35 8 * * 6 mysqldump -u root -pxxxxx atimprocureprod_central_copy > /ATiM/atim-procure/db_dump_for_central/dump_atim_procure_chum_for_central_merge.sql

# sFTP (TODO)